from PIL import Image
import os
import tkinter as tk
from tkinter import filedialog

# ------------------ Ù…Ø±Ø­Ù„Ù‡ Ù…ØªÙ†ÛŒ (ØªØ®ØµØµÛŒâ€ŒØªØ±) ------------------
def text_score(age, bmi, injury, experience, flexibility, reaction, cardio):
    score = 0.0

    if 12 <= age <= 25:
        score += 0.2

    if 18.5 <= bmi <= 25:
        score += 0.2

    if not injury:
        score += 0.2

    if experience >= 2:
        score += 0.15

    if flexibility:
        score += 0.1

    if reaction:
        score += 0.1

    if cardio:
        score += 0.05

    return score

# ------------------ Ù…Ø±Ø­Ù„Ù‡ ØªØµÙˆÛŒØ± ------------------
def image_score(image_path):
    if not image_path or not os.path.isfile(image_path):
        return 0.0

    try:
        img = Image.open(image_path)
        w, h = img.size

        if w >= 600 and h >= 600:
            return 0.15
        elif w >= 400 and h >= 400:
            return 0.1
        else:
            return 0.05
    except:
        return 0.0

# ------------------ Ù…Ø±Ø­Ù„Ù‡ ÙˆÛŒØ¯Ø¦Ùˆ (Ø¨Ø¯ÙˆÙ† OpenCV) ------------------
def video_score(video_path):
    if not video_path or not os.path.isfile(video_path):
        return 0.0

    file_size_mb = os.path.getsize(video_path) / (1024 * 1024)

    score = 0.0

    # ÙØ§ÛŒÙ„ ÙˆØ§Ù‚Ø¹ÛŒ ØªÙ…Ø±ÛŒÙ† (Ù†Ù‡ ÙˆÛŒØ¯Ø¦ÙˆÛŒ Ø®Ø§Ù„ÛŒ)
    if file_size_mb >= 5:
        score += 0.15
    elif file_size_mb >= 2:
        score += 0.1
    else:
        score += 0.05

    return score

# ------------------ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ØµÙ„ÛŒ ------------------
def main():
    print("ğŸ¥‹ Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªØ¹Ø¯Ø§Ø¯â€ŒÛŒØ§Ø¨ÛŒ Ú©Ø§Ø±Ø§ØªÙ‡ (Ù†Ø³Ø®Ù‡ Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ Python 3.14) ğŸ¥‹\n")

    age = int(input("Ø³Ù†: "))
    height = float(input("Ù‚Ø¯ (cm): "))
    weight = float(input("ÙˆØ²Ù† (kg): "))
    injury = input("Ø¢Ø³ÛŒØ¨ ÙØ¹Ø§Ù„ Ø²Ø§Ù†Ùˆ/Ù…Ú†ØŸ (y/n): ").lower() == 'y'

    experience = int(input("Ø³Ø§Ø¨Ù‚Ù‡ ØªÙ…Ø±ÛŒÙ† Ø±Ø²Ù…ÛŒ (Ø³Ø§Ù„): "))
    flexibility = input("Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø¨Ø§Ù„Ø§ Ø¯Ø§Ø±ÛŒØŸ (y/n): ").lower() == 'y'
    reaction = input("ÙˆØ§Ú©Ù†Ø´ Ø³Ø±ÛŒØ¹ Ø¯Ø§Ø±ÛŒØŸ (y/n): ").lower() == 'y'
    cardio = input("ØªÙˆØ§Ù† Ù‡ÙˆØ§Ø²ÛŒ Ø®ÙˆØ¨ Ø¯Ø§Ø±ÛŒØŸ (y/n): ").lower() == 'y'

    bmi = weight / ((height / 100) ** 2)
    score_text = text_score(age, bmi, injury, experience, flexibility, reaction, cardio)

    print(f"\nBMI: {bmi:.2f}")
    print(f"Ø§Ù…ØªÛŒØ§Ø² Ù…Ø±Ø­Ù„Ù‡ Ù…ØªÙ†ÛŒ: {score_text:.2f}")

    root = tk.Tk()
    root.withdraw()

    image_path = filedialog.askopenfilename(
        title="Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ±",
        filetypes=[("Image files", "*.jpg *.jpeg *.png")]
    )
    score_img = image_score(image_path)
    print(f"Ø§Ù…ØªÛŒØ§Ø² ØªØµÙˆÛŒØ±: {score_img:.2f}")

    video_path = filedialog.askopenfilename(
        title="Ø§Ù†ØªØ®Ø§Ø¨ ÙˆÛŒØ¯Ø¦Ùˆ ØªÙ…Ø±ÛŒÙ†",
        filetypes=[("Video files", "*.mp4 *.avi *.mov")]
    )
    score_vid = video_score(video_path)
    print(f"Ø§Ù…ØªÛŒØ§Ø² ÙˆÛŒØ¯Ø¦Ùˆ: {score_vid:.2f}")

    final_score = min(score_text + score_img + score_vid, 1.0)

    print("\nğŸ“Š Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ:")
    if final_score >= 0.75:
        print("âœ… Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø§ØªÙ‡")
    elif final_score >= 0.55:
        print("âš ï¸ Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ù…ØªÙˆØ³Ø· â€“ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ…Ø±ÛŒÙ† Ù‡Ø¯ÙÙ…Ù†Ø¯")
    else:
        print("âŒ Ù…Ù†Ø§Ø³Ø¨ Ù…Ø³ÛŒØ± Ù‚Ù‡Ø±Ù…Ø§Ù†ÛŒ Ù†ÛŒØ³Øª")


    print(f"Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„: {final_score:.2f}")

if __name__ == "__main__":
    main()
